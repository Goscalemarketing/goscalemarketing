<!DOCTYPE html>
<html>
<head>
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.1.1/model-viewer.min.js"></script>
  <style>
    body { margin: 0; height: 100vh; background: #000; }
    model-viewer { width: 100%; height: 100%; }

    /* Forzamos que el botón AR sea gigante e invisible pero que cubra todo, 
       para ver si así captura el toque inicial mejor */
    .ar-instruction-overlay {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,0.9);
      color: #000;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      pointer-events: none; /* No bloquea el toque */
      font-family: sans-serif;
      z-index: 100;
      display: none;
    }
  </style>
</head>
<body>

  <div id="instrucciones" class="ar-instruction-overlay">
    Mueve el móvil en círculos <br>
    y <b>toca el centro de la pantalla</b>
  </div>

  <model-viewer 
    id="menu-ar"
    src="Pruebas.glb" 
    ar 
    ar-modes="webxr" 
    ar-scale="fixed"
    camera-controls
    interaction-prompt="auto"
    /* Ajustes de rendimiento de foro */
    shadow-intensity="0" 
    powerPreference="high-performance"
  >
    <button slot="ar-button" style="padding: 20px; background: white; border-radius: 50px; position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); font-weight: bold;">
      ABRIR CÁMARA
    </button>
  </model-viewer>

  <script>
    const mv = document.querySelector('#menu-ar');
    const inst = document.querySelector('#instrucciones');

    mv.addEventListener('ar-status', (event) => {
      if(event.detail.status === 'session-started') {
        inst.style.display = 'block';
      } else {
        inst.style.display = 'none';
      }
    });

    // TRUCO DE FORO: Forzar el hit-test cada vez que se toca CUALQUIER parte
    mv.addEventListener('click', (event) => {
      if (mv.canActivateAR) {
         // Intentamos forzar la colocación si el sistema está listo
         console.log("Toque registrado en sesión");
      }
    });
  </script>
</body>
</html>
